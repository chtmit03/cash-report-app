<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <style>
    body { font-family: 'Sarabun', sans-serif; background-color: #f5f5f5; padding: 20px; font-size: 14px; }
    .form-page { background: white; padding: 40px; max-width: 850px; margin: auto; border: 1px solid #ccc; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    table { width: 100%; border-collapse: collapse; margin-bottom: 15px; }
    td { padding: 5px; vertical-align: middle; }
    input[type="text"], input[type="number"], input[type="date"], select { width: 100%; border: 1px solid #ccc; padding: 4px; box-sizing: border-box; font-family: 'Sarabun', sans-serif; }
    select.red-select { color: red; font-weight: bold; border: none; background: transparent; -webkit-appearance: none; cursor: pointer; }
    .bg-gray { background-color: #f2f2f2; }
    .border-black td { border: 1px solid black; }
    .border-dotted td { border: 1px dotted #666; }
    .text-red { color: red; font-weight: bold; }
    .title { color: #003366; font-weight: bold; font-size: 18px; margin: 20px 0; }
    .sum-box { border-bottom: 3px double black; font-weight: bold; display: inline-block; min-width: 80px; text-align: center; }
    .input-fill { background-color: #f2f2f2; border: 1px solid #ccc !important; }
    .status-display { background-color: #ddd; padding: 5px 15px; border: none; color: #003366; font-weight: bold; display: inline-block; }
    .memo-line { background: transparent; border: none; height: 28px; width: 100%; display: block; }
    .hr-dotted { border: 0.5px dotted #999; margin: 0; }
  </style>
</head>
<body>

<div class="form-page">
  <table style="width: 50%;">
    <tr class="border-dotted"><td>สำนักงาน</td><td><input type="text" class="input-fill" placeholder="ระบุชื่อสำนักงาน"></td></tr>
    <tr class="border-dotted"><td>วันที่เข้าตรวจ</td><td><input type="date" class="input-fill"></td></tr>
    <tr class="border-dotted"><td>ผู้ตรวจ</td><td><input type="text" class="input-fill" placeholder="ระบุชื่อผู้ตรวจ"></td></tr>
  </table>

  <div class="title">การปฏิบัติงาน เพื่อความปลอดภัยและรอบคอบ ถูกต้อง</div>

  <table style="width: 50%;" class="border-black">
    <tr><td width="60%">ตู้นิรภัย</td><td><select class="red-select"><option>มี</option><option>ไม่มี</option></select></td></tr>
    <tr><td>ลักษณะตู้นิรภัย</td><td><select class="red-select"><option>แบบหมุนรหัส</option><option>แบบดิจิทัล</option></select></td></tr>
    <tr><td>การปิดล็อกด้วยรหัส</td><td><select class="red-select"><option>ปิดล็อกรหัสได้ปกติ</option><option>ปิดล็อกด้วยรหัสไม่ได้</option></select></td></tr>
    <tr><td>การทดสอบการใช้งาน</td><td><select class="red-select"><option>ผ่านทุกคน</option><option>ผ่านบางคน</option><option>ไม่ผ่านทุกคน</option></select></td></tr>
  </table>

  <p>บันทึกเพิ่มเติม</p>
  <div class="bg-gray" style="border: 1px solid #ccc; margin-bottom: 20px;">
    <input type="text" class="memo-line">
    <hr class="hr-dotted">
    <input type="text" class="memo-line">
    <hr class="hr-dotted">
    <input type="text" class="memo-line">
  </div>

  <div class="title">เงินสดคงเหลือ</div>

  <div style="display: flex; gap: 40px; align-items: flex-start; margin-bottom: 20px;">
    <div style="flex: 1;">
      <table class="border-black">
        <tr><td width="50%">ยอดยกมา</td><td><input type="number" class="input-fill text-red" id="start_bal" oninput="calcAll()"></td></tr>
        <tr><td>ยอดรับเงิน</td><td><input type="number" class="input-fill" id="receive_bal" oninput="calcAll()"></td></tr>
        <tr><td>ยอดจ่ายเงิน</td><td><input type="number" class="input-fill" id="pay_bal" oninput="calcAll()"></td></tr>
        <tr><td>ยอดจัดใหม่</td><td><input type="number" class="input-fill" id="adjust_bal" oninput="calcAll()"></td></tr>
      </table>
      <div style="margin-top: 20px;">
        เงินสดคงเหลือ <span id="left_sum_display" class="sum-box text-red" style="margin-left: 50px;">0</span>
      </div>
    </div>

    <div style="flex: 1.2;">
      <table class="border-black">
        <tr class="bg-gray"><td colspan="2">รายละเอียดเงินสดในมือ</td><td>รวมเงิน</td></tr>
        <tr><td>1000</td><td><input type="number" id="q1000" oninput="calcAll()"></td><td id="t1000">0</td></tr>
        <tr><td>500</td><td><input type="number" id="q500" oninput="calcAll()"></td><td id="t500">0</td></tr>
        <tr><td>100</td><td><input type="number" id="q100" oninput="calcAll()"></td><td id="t100">0</td></tr>
        <tr><td>50</td><td><input type="number" id="q50" oninput="calcAll()"></td><td id="t50">0</td></tr>
        <tr><td>20</td><td><input type="number" id="q20" oninput="calcAll()"></td><td id="t20">0</td></tr>
        <tr><td>10</td><td><input type="number" id="q10" oninput="calcAll()"></td><td id="t10">0</td></tr>
        <tr><td>5</td><td><input type="number" id="q5" oninput="calcAll()"></td><td id="t5">0</td></tr>
        <tr><td>2</td><td><input type="number" id="q2" oninput="calcAll()"></td><td id="t2">0</td></tr>
        <tr><td>1</td><td><input type="number" id="q1" oninput="calcAll()"></td><td id="t1">0</td></tr>
        <tr class="bg-gray"><td colspan="2" style="text-align: right;">รวมเงิน</td><td id="right_total" class="text-red sum-box">0</td></tr>
      </table>
    </div>
  </div>

  <div style="margin-bottom: 10px;">
    <span class="text-red">รหัสเงินเกิน (กรณีเงินสดคงเหลือมาเกิน 7,000)</span>
    <input type="text" class="input-fill" style="width: 100px; border: 1px solid black; margin-left: 10px; display: inline-block;">
  </div>

  <div style="margin-bottom: 5px;">
    <div id="account_status" class="status-display">ตรงตามบัญชี</div>
  </div>
  
  <div class="bg-gray" style="border: 1px solid #ccc; margin-bottom: 25px;">
    <input type="text" class="memo-line">
    <hr class="hr-dotted">
    <input type="text" class="memo-line">
  </div>

  <div class="title" style="font-size: 16px;">เช็คประกอบการกู้ยืม</div>
  
  <table>
    <tr>
      <td width="25%">รายงานจากฝ่ายการเงิน</td>
      <td width="20%"><input type="number" class="input-fill" style="width: 60px; display:inline-block;"> ฉบับ</td>
      <td>ตรวจสอบแล้ว <select class="red-select" style="width: auto;"><option>ถูกต้อง</option><option>ไม่ถูกต้อง</option></select></td>
    </tr>
  </table>
  <div class="bg-gray" style="border: 1px solid #ccc; margin-bottom: 10px;">
    <input type="text" class="memo-line">
    <hr class="hr-dotted">
    <input type="text" class="memo-line">
  </div>
  
  <table>
    <tr>
      <td width="25%">รายการเช็คหมดอายุ</td>
      <td><input type="number" class="input-fill" style="width: 60px; display:inline-block;"> ฉบับ</td>
    </tr>
  </table>
  <div class="bg-gray" style="border: 1px solid #ccc;">
    <input type="text" class="memo-line">
    <hr class="hr-dotted">
    <input type="text" class="memo-line">
  </div>

</div>

<script>
  function calcAll() {
    let start = Number(document.getElementById('start_bal').value) || 0;
    let receive = Number(document.getElementById('receive_bal').value) || 0;
    let pay = Number(document.getElementById('pay_bal').value) || 0;
    let adjust = Number(document.getElementById('adjust_bal').value) || 0;
    let leftRes = (start + receive) - pay - adjust;
    document.getElementById('left_sum_display').innerText = leftRes.toLocaleString();

    const denoms = [1000, 500, 100, 50, 20, 10, 5, 2, 1];
    let rightTotal = 0;
    denoms.forEach(d => {
      let qty = document.getElementById('q' + d).value || 0;
      let sum = qty * d;
      document.getElementById('t' + d).innerText = sum.toLocaleString();
      rightTotal += sum;
    });
    document.getElementById('right_total').innerText = rightTotal.toLocaleString();

    let statusBox = document.getElementById('account_status');
    if (leftRes === rightTotal) {
      statusBox.innerText = "ตรงตามบัญชี";
      statusBox.style.color = "#003366";
    } else {
      statusBox.innerText = "..ไม่ถูกต้อง..";
      statusBox.style.color = "red";
    }
  }
</script>

</body>
</html>
