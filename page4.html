<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;600;700;800&display=swap" rel="stylesheet">
  <title>หน้า 4 - ทั่วไป (Custom Layout)</title>

  <style>
    body { font-size: 16px; color: #333; font-family: 'Sarabun', sans-serif; background-color: #f4f7fe; }
    .page4-grid { display: grid; grid-template-columns: 1fr; gap: 20px; margin-bottom: 25px; }
    
    .card { background: white; border-radius: 20px; padding: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.03); border: none; height: 100%; box-sizing: border-box; }
    
    /* นำขีดหน้าหัวข้อออก */
    .card-title { font-size: 20px; margin-bottom: 20px; font-weight: 800; color: #1a237e; text-align: left; border-left: none; padding-left: 0; }
    .sub-section-title { font-weight: 800; font-size: 16px; color: #2d46b9; margin: 15px 0 10px 0; display: block; text-align: left; }

    .clean-row { display: grid; grid-template-columns: 180px 145px 1fr; gap: 12px; align-items: center; padding: 10px 0; border-bottom: 1px solid #f0f2f5; }
    .clean-row:last-child { border-bottom: none; }
    .row-label { font-weight: 600; color: #444; font-size: 14px; text-align: left; }

    .modern-select { background: #fff; border: 1px solid #e0e6ed; border-radius: 10px; padding: 8px; font-family: 'Sarabun'; cursor: pointer; font-size: 13px; color: #cf1322; font-weight: 700; width: 100%; }
    .modern-input { background: #fff; border: 1px solid #e0e6ed; border-radius: 10px; padding: 10px 15px; font-family: 'Sarabun'; font-size: 14px; width: 100%; box-sizing: border-box; outline: none; }
    
    .two-column-layout { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
    .triple-layout { display: grid; grid-template-columns: 1fr; gap: 10px; }

    @media (max-width: 1200px) { .two-column-layout { grid-template-columns: 1fr; } }

    .footer-nav { display: flex; justify-content: space-between; margin-top: 30px; padding-bottom: 40px; }
    .btn-back { background-color: #e2e8f0; color: #475569; padding: 12px 25px; border-radius: 30px; text-decoration: none; font-weight: 700; }
    .btn-save { background: #5c67f2; color: white; padding: 12px 40px; border-radius: 15px; border: none; font-weight: 800; cursor: pointer; }

    /* ตกแต่งส่วนจำนวนพนักงาน */
    .staff-count-group { display: flex; align-items: center; gap: 10px; margin-bottom: 15px; }
    .staff-input { width: 80px; text-align: center; color: #cf1322; font-weight: 800; }
  </style>
</head>

<body>
  <div class="container">
    <div class="header-container" style="text-align: left;">
      <div class="header-group"><label>สาขา / สำนักงาน</label><input type="text" id="branchName" class="modern-input" placeholder=""></div>
      <div class="header-group"><label>วันที่ตรวจสอบ</label><input type="date" id="auditDate" class="modern-input"></div>
      <div class="header-group"><label>ผู้ตรวจสอบ</label><input type="text" id="auditorName" class="modern-input" placeholder=""></div>
    </div>

    <div class="tab-menu">
      <a href="page1.html" class="tab-btn">หน้า 1: เงินสด & เช็ค</a>
      <a href="page2.html" class="tab-btn">หน้า 2: ภาษี</a>
      <a href="page3.html" class="tab-btn">หน้า 3: การเงินและเอกสาร</a>
      <a href="page4.html" class="tab-btn active">หน้า 4: ทั่วไป</a>
    </div>

    <div class="page4-grid">
      
      <div class="card">
        <div class="card-title">อุปกรณ์ไอที / สำนักงาน / การตลาด</div>
        <div class="triple-layout">
          <div id="it-section"><span class="sub-section-title">อุปกรณ์ไอที</span></div>
          <div id="office-section" style="margin-top:20px;"><span class="sub-section-title">อุปกรณ์สำนักงาน</span></div>
          <div id="market-section" style="margin-top:20px;"><span class="sub-section-title">อุปกรณ์การตลาด</span></div>
        </div>
      </div>

      <div class="two-column-layout">
        <div class="card">
          <div class="card-title">สถานประกอบการ</div>
          <div id="establishment-section"></div>
        </div>

        <div class="card">
          <div class="card-title">พนักงานและการบริการ</div>
          <div id="service-section">
            <div class="clean-row" style="grid-template-columns: 140px 130px 1fr;">
              <div class="row-label">การแต่งกายพนักงาน</div>
              <select class="modern-select"><option>ผ่าน</option><option>ควรปรับปรุง</option><option>ไม่เหมาะสม</option></select>
              <input type="text" class="modern-input" placeholder="">
            </div>
            <div class="clean-row" style="grid-template-columns: 140px 130px 1fr;">
              <div class="row-label">ความพร้อมในการบริการ</div>
              <select class="modern-select"><option>ผ่าน</option><option>ควรปรับปรุง</option><option>ไม่เหมาะสม</option></select>
              <input type="text" class="modern-input" placeholder="">
            </div>
            <div class="clean-row" style="grid-template-columns: 140px 130px 1fr;">
              <div class="row-label">คุณภาพของพนักงาน</div>
              <select class="modern-select"><option>ผ่าน</option><option>ควรปรับปรุง</option><option>ไม่เหมาะสม</option></select>
              <input type="text" class="modern-input" placeholder="">
            </div>
            <div class="clean-row" style="grid-template-columns: 140px 130px 1fr;">
              <div class="row-label">การเจรจาบริการลูกค้า</div>
              <select class="modern-select"><option>ผ่าน</option><option>ควรปรับปรุง</option><option>ไม่เหมาะสม</option></select>
              <input type="text" class="modern-input" placeholder="">
            </div>
          </div>
        </div>
      </div>

      <div class="two-column-layout">
        <div class="card">
          <div class="card-title">อัปเดตข่าวสารบริษัท (ล่าสุด)</div>
          <div style="display: flex; flex-direction: column; gap: 10px;">
            <input type="text" class="modern-input" placeholder="">
            <input type="text" class="modern-input" placeholder="">
            <input type="text" class="modern-input" placeholder="">
            <input type="text" class="modern-input" placeholder="">
            <input type="text" class="modern-input" placeholder="">
          </div>
        </div>
        
        <div class="card">
          <div class="card-title">ผู้รับผิดชอบดูแล สนง.</div>
          <div style="display: flex; flex-direction: column; gap: 15px;">
            <div>
              <label class="row-label" style="margin-bottom:8px; display:block;">ชื่อผู้รับผิดชอบดูแล</label>
              <input type="text" class="modern-input" placeholder="">
            </div>
            <div>
              <label class="row-label" style="margin-bottom:8px; display:block;">พนักงานในความดูแล</label>
              <div class="staff-count-group">
                <input type="number" class="modern-input staff-input" value="0">
                <span class="row-label">คน</span>
              </div>
            </div>
            <div>
              <label class="row-label" style="margin-bottom:8px; display:block;">ข้อเสนอแนะเพิ่มเติม</label>
              <textarea class="modern-input" style="height: 105px; resize: none;" placeholder=""></textarea>
            </div>
          </div>
        </div>
      </div>

    </div>

    <div class="footer-nav">
      <a href="page3.html" class="btn-back">← ย้อนกลับ</a>
      <button class="btn-save" onclick="alert('บันทึกข้อมูลเรียบร้อย')">บันทึกข้อมูลหน้า 4 ✔</button>
    </div>
  </div>

  <script>
    const eqOptions = ["ใช้งานปกติ", "ชำรุด", "เสีย", "เก่า", "ไม่มี", "ไม่พอใช้งาน", "เปิดไม่ติด", "เปิดติดช้า", "เสื่อมสภาพ", "เก็บไฟไม่อยู่", "สีซีดจาง", "ชำรุด/ฉีกขาด", "ติดตั้งไม่ครบ", "ยังไม่ได้รับของจากฝ่าย"]; 
    const estOptions = ["ผ่าน", "ไม่สะอาด", "ไม่เรียบร้อย", "เก่า/ทรุดโทรม", "ก่อสร้างถนน", "พบปัญหา"]; 

    const itList = ["คอมพิวเตอร์", "จอคอมพิวเตอร์", "เครื่องสำรองไฟ", "Printer/สแกน", "เครื่องพิมพ์ใบเสร็จ", "หมึกปริ้นท์", "อื่นๆ"];
    const officeList = ["เก้าอี้รับรองลูกค้า", "เก้าอี้พนักงาน", "โต๊ะทำงาน", "TV สำนักงาน", "AIR สำนักงาน", "รถใช้สำนักงาน", "มือถือ สนง.", "อื่นๆ"];
    const marketList = ["ป้ายสำนักงาน", "ป้ายแขวนหน้า สนง.", "สติ๊กเกอร์กระจก", "ธงญี่ปุ่น", "ป้ายตาเฮีย ช.", "ป้าย QR code", "ป้าย Free Wifi"];
    const estList = ["พื้นที่ปฏิบัติงาน", "พื้นที่ส่วนอื่นๆ", "การจัดเก็บเอกสาร", "ความสะอาดทั่วไป", "สภาพโดยรอบ", "ความสะดวกพนักงาน", "อาคารสำนักงาน"];

    function renderSection(containerId, items, options) {
      const container = document.getElementById(containerId);
      items.forEach(item => {
        const row = document.createElement('div');
        row.className = 'clean-row';
        let selectHtml = `<select class="modern-select">`;
        options.forEach(opt => selectHtml += `<option>${opt}</option>`);
        selectHtml += `</select>`;

        row.innerHTML = `
          <div class="row-label">${item}</div>
          ${selectHtml}
          <input type="text" class="modern-input" placeholder="">
        `;
        container.appendChild(row);
      });
    }

    window.onload = () => {
      renderSection('it-section', itList, eqOptions);
      renderSection('office-section', officeList, eqOptions);
      renderSection('market-section', marketList, eqOptions);
      renderSection('establishment-section', estList, estOptions);
      
      document.getElementById('branchName').value = localStorage.getItem('global_branch') || '';
      document.getElementById('auditorName').value = localStorage.getItem('global_auditor') || '';
    };
  </script>
</body>
</html>