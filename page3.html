<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;600;700;800;900&display=swap" rel="stylesheet">
  <title>หน้า 3 - การเงินและเอกสาร</title>

  <style>
    body { font-size: 16px; color: #333; font-family: 'Sarabun', sans-serif; }
    .page3-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 25px; margin-bottom: 25px; }
    
    .card-title { font-size: 22px !important; margin-bottom: 20px !important; font-weight: 800 !important; color: #1a237e; }
    
    .sub-section-header { 
      display: flex; 
      justify-content: space-between; 
      align-items: center; 
      margin-bottom: 12px; 
      border-bottom: 2px solid #EEE; 
      padding-bottom: 8px;
    }
    .sub-title-text { font-weight: 800; font-size: 19px; color: #2d46b9; }

    .calc-status { padding: 5px 12px; border-radius: 10px; font-weight: 800; font-size: 14px; border: 1px solid #ddd; display: inline-block; min-width: 90px; text-align: center; }
    .is-ok { background: #eef2ff; color: #2d46b9; border-color: #c9d2f8; }
    .is-error { background: #fff1f0; color: #cf1322; border-color: #ffa39e; }
    .is-match { color: #2d46b9; border: 1px solid #c9d2f8; background: #f0f3ff; }
    .is-mismatch { color: #cf1322; border: 1px solid #ffa39e; background: #fff1f0; }

    .styled-input { border: 1px solid #E0E0E0; border-radius: 10px; padding: 8px 12px; font-family: 'Sarabun'; font-size: 15px; outline: none; }
    .mini-input { width: 65px; text-align: center; font-weight: bold; }
    .full-width-input { width: 100%; margin: 5px 0 15px 0; background: #fafafa; border-radius: 10px; box-sizing: border-box; }
    
    .label-text { font-size: 15px; font-weight: 600; color: #555; }
    .field-label { font-size: 14px; font-weight: 700; color: #333; display: block; margin-top: 10px; }
    
    .report-table { width: 100%; border-collapse: separate; border-spacing: 0; font-size: 13px; margin-top: 10px; border: 1px solid #EEE; border-radius: 12px; overflow: hidden; margin-bottom: 20px; }
    .report-table th, .report-table td { border: 1px solid #EEE; padding: 10px; text-align: center; }
    .report-table th { background: #F9FAFB; color: #666; font-weight: 700; }
    .table-input { width: 95%; border: none; background: transparent; text-align: center; font-family: 'Sarabun'; font-size: 13px; outline: none; }

    .tab-menu { pointer-events: none; margin-bottom: 20px; }
    .full-card { grid-column: span 2; }
    .split-container { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }

    /* ปรับปุ่มให้เหมือนหน้า 2 */
    .footer-nav { display: flex; justify-content: space-between; margin-top: 40px; padding-bottom: 50px; align-items: center; }
    .btn-page2-back { background-color: #e2e8f0; color: #475569; padding: 12px 25px; border-radius: 30px; text-decoration: none; font-weight: 700; font-size: 15px; }
    .btn-page2-next { background: #5c67f2; color: white; padding: 14px 35px; border-radius: 15px; text-decoration: none; font-weight: 700; font-size: 16px; box-shadow: 0 4px 15px rgba(92, 103, 242, 0.3); }
  </style>
</head>

<body>
  <div class="container">
    <div class="header-container">
      <div class="header-group"><label>สาขา / สำนักงาน</label><input type="text" id="branchName" class="styled-input"></div>
      <div class="header-group"><label>วันที่ตรวจสอบ</label><input type="date" id="auditDate" class="styled-input"></div>
      <div class="header-group"><label>ผู้ตรวจสอบ</label><input type="text" id="auditorName" class="styled-input"></div>
    </div>

    <div class="tab-menu">
  <a class="tab-btn" href="page1.html">หน้า 1: เงินสด & เช็ค</a>
  <a class="tab-btn" href="page2.html">หน้า 2: ภาษี</a>
  <a class="tab-btn active" href="page3.html">หน้า 3: การเงินและเอกสาร</a>
  <a class="tab-btn" href="page4.html">หน้า 4: ทั่วไป</a>
</div>

    <div class="page3-grid">
      <div class="card">
        <div class="card-title no-stripe">เล่มทะเบียนหลักประกัน</div>
        
        <div class="sub-section-header"><span class="sub-title-text">เล่มทะเบียน รถยนต์</span><span id="status_car" class="calc-status is-ok">ถูกต้อง</span></div>
        <div style="margin-bottom: 20px;">
          <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
            <span class="label-text">ลิสซิ่ง: <input type="number" id="car_sys" class="styled-input mini-input" oninput="checkCar()"></span>
            <span class="label-text">ตรวจจริง: <input type="number" id="car_real" class="styled-input mini-input" oninput="checkCar()"></span>
            <span class="label-text">นอก สนง.: <input type="number" id="car_out" class="styled-input mini-input" oninput="checkCar()"></span>
          </div>
          <div><span class="label-text">อนุมัติรับทราบโดย:</span> <input type="text" class="styled-input" style="width: 55%; margin-bottom: 5px;"></div>
          
          <label class="field-label">เลขสัญญาเล่มที่อยู่นอก สนง.</label>
          <input type="text" class="styled-input full-width-input" placeholder="ระบุเลขสัญญา...">
          
          <label class="field-label">สาเหตุของเล่มอยู่นอก สนง.คือ</label>
          <input type="text" class="styled-input full-width-input" placeholder="ระบุสาเหตุ...">
          
          <div style="margin-top: 10px; padding: 12px; border: 1px solid #EEE; border-radius: 12px; background: #fcfcfc;">
            <span class="label-text">ปิดบัญชียังไม่รับเล่ม ข้อมูลลิสซิ่ง:</span> <input type="number" id="car_close_sys" class="styled-input mini-input" oninput="checkCloseCar()"> 
            <span class="label-text">ตรวจนับที่ สนง.:</span> <input type="number" id="car_close_real" class="styled-input mini-input" oninput="checkCloseCar()">
            <span id="car_close_status" class="calc-status is-match">ตรงรายงาน</span>
            <textarea class="styled-input full-width-input" rows="2" style="margin-top:8px;" placeholder="บันทึกเพิ่มเติม..."></textarea>
          </div>
        </div>

        <div class="sub-section-header"><span class="sub-title-text">เล่มทะเบียน จักรยานยนต์</span><span id="status_moto" class="calc-status is-ok">ถูกต้อง</span></div>
        <div>
          <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
            <span class="label-text">ลิสซิ่ง: <input type="number" id="moto_sys" class="styled-input mini-input" oninput="checkMoto()"></span>
            <span class="label-text">ตรวจจริง: <input type="number" id="moto_real" class="styled-input mini-input" oninput="checkMoto()"></span>
            <span class="label-text">นอก สนง.: <input type="number" id="moto_out" class="styled-input mini-input" oninput="checkMoto()"></span>
          </div>
          <div><span class="label-text">อนุมัติรับทราบโดย:</span> <input type="text" class="styled-input" style="width: 55%; margin-bottom: 5px;"></div>
          
          <label class="field-label">เลขสัญญาเล่มที่อยู่นอก สนง.</label>
          <input type="text" class="styled-input full-width-input" placeholder="ระบุเลขสัญญา...">
          
          <label class="field-label">สาเหตุของเล่มอยู่นอก สนง.คือ</label>
          <input type="text" class="styled-input full-width-input" placeholder="ระบุสาเหตุ...">
          
          <div style="margin-top: 10px; padding: 12px; border: 1px solid #EEE; border-radius: 12px; background: #fcfcfc;">
            <span class="label-text">ปิดบัญชียังไม่รับเล่ม ข้อมูลลิสซิ่ง:</span> <input type="number" id="moto_close_sys" class="styled-input mini-input" oninput="checkCloseMoto()"> 
            <span class="label-text">ตรวจนับที่ สนง.:</span> <input type="number" id="moto_close_real" class="styled-input mini-input" oninput="checkCloseMoto()">
            <span id="moto_close_status" class="calc-status is-match">ตรงรายงาน</span>
            <textarea class="styled-input full-width-input" rows="2" style="margin-top:8px;" placeholder="บันทึกเพิ่มเติม..."></textarea>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-title no-stripe">เอกสารสำคัญทางบัญชี</div>
        <div style="background:#F6F8FF; padding:15px; border-radius:12px; margin-bottom:20px; font-weight:bold; border:1px solid #d0d7f7; display: flex; align-items: center; gap: 10px;">
          ตรวจสอบเอกสาร ช่วงเดือน: 
          <select class="styled-input" style="width:100px;">
            <script>
              const months = ["ม.ค.","ก.พ.","มี.ค.","เม.ย.","พ.ค.","มิ.ย.","ก.ค.","ส.ค.","ก.ย.","ต.ค.","พ.ย.","ธ.ค."];
              months.forEach(m => document.write(`<option ${m==='ต.ค.'?'selected':''}>${m}</option>`));
            </script>
          </select> 
          ถึง 
          <select class="styled-input" style="width:100px;">
            <script>
              months.forEach(m => document.write(`<option ${m==='ธ.ค.'?'selected':''}>${m}</option>`));
            </script>
          </select>
        </div>
        <table style="width:100%;">
          <script>
            const contractChecks = [
              "สัญญากู้ ครบตามรายงานจัดทำสัญญาและแบบ อส.4ข",
              "รายละเอียดผู้กู้/ผู้ค้ำ และ หลักทรัพย์ ถูกต้อง",
              "หนังสือแนบท้ายยินยอมส่งมอบรถ (ตัวจริง)",
              "เอกสารประกอบสัญญา ครบถ้วนตามระเบียบ",
              "เลขทะเบียนรถถูกต้องตามสมุดเล่มทะเบียน",
              "ลายเซ็นต์ลูกค้า/พนักงาน ครบถ้วนทุกจุด"
            ];
            contractChecks.forEach((text, i) => {
              document.write(`
                <tr>
                  <td style="padding:10px 0; font-size:15px; font-weight:600;">${i+1}. ${text}</td>
                  <td align="right">
                    <select class="calc-status is-ok" style="width:110px;">
                      <option>ครบ</option>
                      <option>ไม่ครบ</option>
                      <option>ถูกต้อง</option>
                      <option>ไม่ถูกต้อง</option>
                    </select>
                  </td>
                </tr>
                <tr><td colspan="2"><input type="text" class="styled-input full-width-input" style="margin-bottom:12px;" placeholder="หมายเหตุ..."></td></tr>
              `);
            });
          </script>
        </table>
      </div>

      <div class="card full-card">
        <div class="card-title no-stripe">สต็อกในความรับผิดชอบ (รถยนต์ / รถจักรยานยนต์)</div>
        <div style="margin-bottom: 10px;">
           <span class="label-text">จำนวนคันทั้งหมด:</span> <input type="text" class="styled-input mini-input" value="0"> คัน
           <span class="label-text" style="margin-left:20px;">จำนวนเล่มทะเบียนในสต็อก:</span> <input type="text" class="styled-input mini-input" value="0"> เล่ม
        </div>
        <table class="report-table">
          <thead>
            <tr><th>ทะเบียน</th><th>รุ่นรถ</th><th>ปี</th><th>เครื่อง</th><th>เกียร์</th><th>ตัวถัง</th><th>ราคาตั้งขาย</th><th>บันทึกเพิ่มเติม</th></tr>
          </thead>
          <tbody>
            <script>
              for(let i=0; i<5; i++) document.write('<tr>'+'<td><input type="text" class="table-input"></td>'.repeat(8)+'</tr>');
            </script>
          </tbody>
        </table>
      </div>

      <div class="card full-card">
        <div class="card-title no-stripe">รายการเล่มทะเบียนค้างนาน (เกิน 2 ปี)</div>
        <div class="split-container">
          <div>
            <div class="sub-title-text" style="font-size: 18px; margin-bottom: 10px;">1. ปิดบัญชีไม่รับเล่มเกิน 2 ปี (จำนวน <input type="text" class="styled-input mini-input" value="0"> เล่ม)</div>
            <table class="report-table">
              <thead><tr><th>เลขสัญญา</th><th>ทะเบียน</th><th>วันที่ปิด บ/ช</th><th>รายละเอียดเพิ่มเติม</th></tr></thead>
              <tbody><script>for(let i=0; i<5; i++) document.write('<tr>'+'<td><input type="text" class="table-input"></td>'.repeat(4)+'</tr>');</script></tbody>
            </table>
          </div>
          <div>
            <div class="sub-title-text" style="font-size: 18px; margin-bottom: 10px;">2. ทะเบียนขาดตั้งแต่ 2 ปีขึ้นไป (จำนวน <input type="text" class="styled-input mini-input" value="0"> เล่ม)</div>
            <table class="report-table">
              <thead><tr><th>เลขสัญญา</th><th>ทะเบียน</th><th>ภาษีขาด</th><th>ค้างค่างวด</th><th>รายละเอียด</th></tr></thead>
              <tbody><script>for(let i=0; i<5; i++) document.write('<tr>'+'<td><input type="text" class="table-input"></td>'.repeat(5)+'</tr>');</script></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

   <div style="display: flex; justify-content: space-between; margin-top: 30px; padding-bottom: 50px;">
      <a href="page2.html" class="btn-back">← ย้อนกลับ (หน้า 2)</a>
      <a href="page4.html" class="btn-next">หน้าถัดไป (หน้า 4:ทั่วไป ) →</a>
    </div>
  </div>

  <script>
    function checkCar() {
      const s = +document.getElementById('car_sys').value || 0;
      const r = +document.getElementById('car_real').value || 0;
      const o = +document.getElementById('car_out').value || 0;
      const b = document.getElementById('status_car');
      b.innerText = (s - r - o === 0) ? "ถูกต้อง" : "ไม่ถูกต้อง";
      b.className = (s - r - o === 0) ? "calc-status is-ok" : "calc-status is-error";
    }
    function checkMoto() {
      const s = +document.getElementById('moto_sys').value || 0;
      const r = +document.getElementById('moto_real').value || 0;
      const o = +document.getElementById('moto_out').value || 0;
      const b = document.getElementById('status_moto');
      b.innerText = (s - r - o === 0) ? "ถูกต้อง" : "ไม่ถูกต้อง";
      b.className = (s - r - o === 0) ? "calc-status is-ok" : "calc-status is-error";
    }
    function checkCloseCar() {
      const s = document.getElementById('car_close_sys').value;
      const r = document.getElementById('car_close_real').value;
      const b = document.getElementById('car_close_status');
      b.innerText = (s === r) ? "ตรงรายงาน" : "ไม่ตรงรายงาน";
      b.className = (s === r) ? "calc-status is-match" : "calc-status is-mismatch";
    }
    function checkCloseMoto() {
      const s = document.getElementById('moto_close_sys').value;
      const r = document.getElementById('moto_close_real').value;
      const b = document.getElementById('moto_close_status');
      b.innerText = (s === r) ? "ตรงรายงาน" : "ไม่ตรงรายงาน";
      b.className = (s === r) ? "calc-status is-match" : "calc-status is-mismatch";
    }
    window.onload = () => {
      document.getElementById('branchName').value = localStorage.getItem('global_branch') || '';
      document.getElementById('auditorName').value = localStorage.getItem('global_auditor') || '';
      document.getElementById('auditDate').value = localStorage.getItem('global_date') || '';
    };
  </script>
</body>
</html>